resourceType: Parameters
parameter:
- name: questionnaire
  resource:
    subjectType:
    - Encounter
    - Patient
    launchContext:
    - name: Patient
      type: Patient
    name: Vitals
    item:
    - text: PatientId
      type: string
      hidden: true
      linkId: patientId
      initialExpression:
        language: text/fhirpath
        expression: "%Patient.id"
    - text: PatientName
      type: string
      hidden: true
      linkId: patientName
      initialExpression:
        language: text/fhirpath
        expression: "%Patient.name.given[0] + ' ' + %Patient.name.family"
    - text: Height
      type: integer
      unit: cm
      linkId: height
    - text: Weight
      type: integer
      unit: kg
      linkId: weight
    - text: Temperature
      type: integer
      unit: Celsius
      linkId: temperature
    - text: Oxygen saturation
      type: integer
      unit: "%"
      linkId: oxygen-saturation
    - text: Pulse rate
      type: integer
      unit: bpm
      linkId: pulse-rate
    - text: Respiratory Rate
      type: integer
      unit: bpm
      linkId: respiratory-rate
    - item:
      - item:
        - text: BP systolic
          type: integer
          unit: mmHg
          linkId: blood-pressure-systolic
        - text: BP diastolic
          type: integer
          unit: mmHg
          linkId: blood-pressure-diastolic
        type: group
        linkId: blood-pressure-systolic-diastolic
        itemControl:
          coding:
          - code: blood-pressure
      - text: Positions
        type: choice
        linkId: blood-pressure-positions
        itemControl:
          coding:
          - code: inline-choice
        answerOption:
        - value:
            Coding:
              code: sitting
              display: Sitting
        - value:
            Coding:
              code: lying
              display: Lying
        - value:
            Coding:
              code: standing
              display: Standing
      - text: Arm
        type: choice
        linkId: blood-pressure-arm
        itemControl:
          coding:
          - code: inline-choice
        answerOption:
        - value:
            Coding:
              code: biceps-left
              display: Biceps left
        - value:
            Coding:
              code: biceps-right
              display: Biceps right
      text: Blood Pressure
      type: group
      linkId: blood-pressure
    - text: BMI
      type: integer
      unit: kg/m2
      linkId: bmi
      readOnly: true
      required: true
      calculatedExpression:
        language: text/fhirpath
        expression: "(%QuestionnaireResponse.item.where(linkId='weight').answer.value.integer
          / ((%QuestionnaireResponse.item.where(linkId='height').answer.value.integer
          / 100) * (%QuestionnaireResponse.item.where(linkId='height').answer.value.integer
          / 100))).round(2)"
    mapping:
    - resourceType: Mapping
      id: vitals
    resourceType: Questionnaire
    status: active
    assembledFrom: vitals
- name: questionnaire_response
  resource:
    questionnaire: vitals
    meta:
      lastUpdated: '2023-03-20T07:45:38.346625Z'
      createdAt: '2023-03-20T07:45:38.346625Z'
      versionId: '1829'
    encounter:
      id: 03c64740-1ef0-4121-baa8-b88bc3963ea8
      resourceType: Encounter
    item:
    - answer:
      - value:
          string: f44ef5b7-b12a-4d90-9320-e4af9918710a
      linkId: patientId
    - answer:
      - value: {}
      linkId: patientName
    - answer:
      - value:
          integer: 185
      linkId: height
    - answer:
      - value:
          integer: 73
      linkId: weight
    - answer:
      - value:
          integer: 36.7
      linkId: temperature
    - answer:
      - value:
          integer: 99
      linkId: oxygen-saturation
    - answer:
      - value:
          integer: 84
      linkId: pulse-rate
    - answer:
      - value: {}
      linkId: respiratory-rate
    - item:
      - item:
        - answer:
          - value:
              integer: 120
          linkId: blood-pressure-systolic
        - answer:
          - value:
              integer: 80
          linkId: blood-pressure-diastolic
        linkId: blood-pressure-systolic-diastolic
      - answer:
        - value:
            Coding:
              code: sitting
              display: Sitting
        linkId: blood-pressure-positions
      - answer:
        - value:
            Coding:
              code: biceps-left
              display: Biceps left
        linkId: blood-pressure-arm
      linkId: blood-pressure
    - answer:
      - value:
          integer: 21.33
      linkId: bmi
    resourceType: QuestionnaireResponse
    source:
      id: f44ef5b7-b12a-4d90-9320-e4af9918710a
      resourceType: Patient
    status: completed
    id: 306294f8-9ed7-437e-9200-965020cdb753
    authored: '2023-03-20T07:45:37Z'
- name: Patient
  resource:
    resourceType: Patient
    id: example
- name: Encounter
  resource:
    resourceType: Encounter
    id: example
